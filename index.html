<!doctype html>
<html>
    <head>
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
        <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    </head>
    <body style="margin: 0; overflow: hidden;">
        <a-scene
            vr-mode-ui="enabled: false;"
            loading-screen="enabled: false;"
            renderer="logarithmicDepthBuffer: true;"
            arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
            id="scene"
            embedded
            swipe-handler
        >
            <a-assets>
                <a-asset-item
                    id="sushi-asset"
                    src="assets/asset.gltf"
                ></a-asset-item>

                <a-asset-item
                    id="momo-asset"
                    src="assets/momo_food.glb"
                ></a-asset-item>

                <a-asset-item
                    id="noodles-asset"
                    src="assets/noodles_with_soybean_paste_scaniverse_lidar.glb"
                ></a-asset-item>
            </a-assets>

            <a-marker
                id="animated-marker"
                type="pattern"
                preset="custom"
                url="assets/marker.patt"
                id="markerA"
            >
                <a-entity
                    id="sushi-model"
                    position="0 0 -2"
                    scale="0.01132191229759719 0.01132191229759719 0.01132191229759719"
                    gltf-model="#sushi-asset"
                    visible="true"
                ></a-entity>

                <a-entity
                    id="momo-model"
                    position="0 0 -2"
                    scale="0.01132191229759719 0.01132191229759719 0.01132191229759719"
                    gltf-model="#momo-asset"
                    visible="false"
                ></a-entity>
                
                <a-entity
                    id="noodles-model"
                    position="0 0 -2"
                    scale="0.01132191229759719 0.01132191229759719 0.01132191229759719"
                    gltf-model="#noodles-asset"
                    visible="false"
                ></a-entity>
            </a-marker>
            <a-entity camera></a-entity>
        </a-scene>

        <script>
            AFRAME.registerComponent('swipe-handler', {
                init: function () {
                    // Updated the list to include all three models
                    this.models = [
                        document.querySelector('#sushi-model'),
                        document.querySelector('#momo-model'),
                        document.querySelector('#noodles-model')
                    ];
                    this.currentIndex = 0;
                    this.touchStartX = 0;

                    this.el.sceneEl.addEventListener('touchstart', (e) => {
                        this.touchStartX = e.changedTouches[0].clientX;
                    });

                    this.el.sceneEl.addEventListener('touchend', (e) => {
                        const touchEndX = e.changedTouches[0].clientX;
                        const deltaX = touchEndX - this.touchStartX;

                        if (Math.abs(deltaX) > 50) {
                            this.models[this.currentIndex].setAttribute('visible', 'false');

                            if (deltaX < 0) { // Swipe Left
                                this.currentIndex = (this.currentIndex + 1) % this.models.length;
                            } else { // Swipe Right
                                this.currentIndex = (this.currentIndex - 1 + this.models.length) % this.models.length;
                            }
                            
                            this.models[this.currentIndex].setAttribute('visible', 'true');
                        }
                    });
                }
            });
        </script>
    </body>
</html>



